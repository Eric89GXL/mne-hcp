<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Compute inverse solution for evoked data &mdash; MNE-HCP 0.1.dev6 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.3.4/cosmo/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1.dev6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="MNE-HCP 0.1.dev6 documentation" href="../index.html" />

<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>







  </head>
  <body role="document">





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          MNE-HCP</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1.dev6</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../auto_examples/index.html">Examples</a></li>
                <li><a href="index.html">Tutorials</a></li>
                <li><a href="../python_reference.html">API</a></li>
                <li><a href="https://github.com/mne-tools/mne-hcp">GitHub</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Compute inverse solution for evoked data</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/auto_tutorials/plot_compute_evoked_inverse_solution.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><ul>
<li><a class="reference internal" href="#">Compute inverse solution for evoked data</a></li>
</ul>

<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12">
      
  <div class="section" id="compute-inverse-solution-for-evoked-data">
<span id="tut-compute-inverse-erf"></span><span id="sphx-glr-auto-tutorials-plot-compute-evoked-inverse-solution-py"></span><h1>Compute inverse solution for evoked data<a class="headerlink" href="#compute-inverse-solution-for-evoked-data" title="Permalink to this headline">Â¶</a></h1>
<p>Here we&#8217;ll use our knowledge from the other examples and tutorials
to compute an inverse solution and apply it on event related fields.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Author: Denis A. Enegemann</span>
<span class="c1"># License: BSD 3 clause</span>

<span class="kn">import</span> <span class="nn">os.path</span> <span class="kn">as</span> <span class="nn">op</span>
<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">import</span> <span class="nn">hcp</span>
<span class="kn">from</span> <span class="nn">hcp</span> <span class="kn">import</span> <span class="n">io</span>
<span class="kn">from</span> <span class="nn">hcp</span> <span class="kn">import</span> <span class="n">preprocessing</span> <span class="k">as</span> <span class="n">preproc</span>
</pre></div>
</div>
<p>we assume our data is inside a designated folder under $HOME</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">storage_dir</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~/mne-hcp-data&#39;</span><span class="p">)</span>
<span class="n">hcp_path</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">storage_dir</span><span class="p">,</span> <span class="s1">&#39;HCP&#39;</span><span class="p">)</span>
<span class="n">recordings_path</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">storage_dir</span><span class="p">,</span> <span class="s1">&#39;hcp-meg&#39;</span><span class="p">)</span>
<span class="n">subjects_dir</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">storage_dir</span><span class="p">,</span> <span class="s1">&#39;hcp-subjects&#39;</span><span class="p">)</span>
<span class="n">subject</span> <span class="o">=</span> <span class="s1">&#39;105923&#39;</span>  <span class="c1"># our test subject</span>
<span class="n">data_type</span> <span class="o">=</span> <span class="s1">&#39;task_working_memory&#39;</span>
<span class="n">run_index</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>We&#8217;re reading the evoked data.
These are the same as in <a class="reference internal" href="../auto_examples/plot_evoked_data.html#tut-plot-evoked"><span>Visualize evoked data</span></a></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">hcp_evokeds</span> <span class="o">=</span> <span class="n">hcp</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_evokeds_hcp</span><span class="p">(</span><span class="n">onset</span><span class="o">=</span><span class="s1">&#39;stim&#39;</span><span class="p">,</span> <span class="n">subject</span><span class="o">=</span><span class="n">subject</span><span class="p">,</span>
                                      <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span> <span class="n">hcp_path</span><span class="o">=</span><span class="n">hcp_path</span><span class="p">)</span>
<span class="k">for</span> <span class="n">evoked</span> <span class="ow">in</span> <span class="n">hcp_evokeds</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">evoked</span><span class="o">.</span><span class="n">comment</span> <span class="o">==</span> <span class="s1">&#39;Wrkmem_LM-TIM-face_BT-diff_MODE-mag&#39;</span><span class="p">:</span>
        <span class="k">continue</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre><span></span>Reading 4D PDF file /Users/dengemann/mne-hcp-data/HCP/105923/unprocessed/MEG/6-Wrkmem/4D/c,rfDC...
Creating Neuromag info structure ...
... Setting channel info structure.
... no headshape file supplied, doing nothing.
Currently direct inclusion of 4D weight tables is not supported. For critical use cases please take into account the MNE command &quot;mne_create_comp_data&quot; to include weights as printed out by the 4D &quot;print_table&quot; routine.
</pre></div>
</div>
<p>We&#8217;ll now use a convenience function to get our forward and source models
instead of computing them by hand.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">src_outputs</span> <span class="o">=</span> <span class="n">hcp</span><span class="o">.</span><span class="n">anatomy</span><span class="o">.</span><span class="n">compute_forward_stack</span><span class="p">(</span>
    <span class="n">subject</span><span class="o">=</span><span class="n">subject</span><span class="p">,</span> <span class="n">subjects_dir</span><span class="o">=</span><span class="n">subjects_dir</span><span class="p">,</span>
    <span class="n">hcp_path</span><span class="o">=</span><span class="n">hcp_path</span><span class="p">,</span> <span class="n">recordings_path</span><span class="o">=</span><span class="n">recordings_path</span><span class="p">,</span>
    <span class="c1"># speed up computations here. Setting `add_dist` to True may improve the</span>
    <span class="c1"># accuracy.</span>
    <span class="n">src_params</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">add_dist</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
    <span class="n">info_from</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span> <span class="n">run_index</span><span class="o">=</span><span class="n">run_index</span><span class="p">))</span>

<span class="n">fwd</span> <span class="o">=</span> <span class="n">src_outputs</span><span class="p">[</span><span class="s1">&#39;fwd&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre><span></span>Setting up the source space with the following parameters:

SUBJECTS_DIR = /Users/dengemann/mne-hcp-data/hcp-subjects
Subject      = fsaverage
Surface      = white
Octahedron subdivision grade 6

&gt;&gt;&gt; 1. Creating the source space...

Doing the octahedral vertex picking...
Loading /Users/dengemann/mne-hcp-data/hcp-subjects/fsaverage/surf/lh.white...
Triangle file: created by nicks on Tue Aug 14 13:43:20 2007 nvert = 163842 ntri = 327680
    Warning: zero size triangle # 3
    Warning: zero size triangle # 4
    Triangle neighbors and vertex normals...
Loading geometry from /Users/dengemann/mne-hcp-data/hcp-subjects/fsaverage/surf/lh.sphere...
Triangle file: created by greve on Thu Jun  8 19:17:51 2006 nvert = 163842 ntri = 327680
Mapping lh fsaverage -&gt; oct (6) ...
Setting up the triangulation for the decimated surface...
loaded lh.white 4098/163842 selected to source space (oct = 6)

Loading /Users/dengemann/mne-hcp-data/hcp-subjects/fsaverage/surf/rh.white...
Triangle file: created by nicks on Tue Aug 14 14:10:55 2007 nvert = 163842 ntri = 327680
    Warning: zero size triangle # 3
    Warning: zero size triangle # 4
    Triangle neighbors and vertex normals...
Loading geometry from /Users/dengemann/mne-hcp-data/hcp-subjects/fsaverage/surf/rh.sphere...
Triangle file: created by greve on Thu Jun  8 19:17:51 2006 nvert = 163842 ntri = 327680
Mapping rh fsaverage -&gt; oct (6) ...
Setting up the triangulation for the decimated surface...
loaded rh.white 4098/163842 selected to source space (oct = 6)

You are now one step closer to computing the gain matrix
Reading destination surface /Users/dengemann/mne-hcp-data/hcp-subjects/105923/surf/lh.white
    Triangle neighbors and vertex normals...
Mapping lh fsaverage -&gt; 105923 (nearest neighbor)...
Triangle file: created by greve on Thu Jun  8 19:17:51 2006 nvert = 163842 ntri = 327680
Triangle file: created by HCPpipeline on Tue Aug 19 21:54:25 2014 nvert = 146591 ntri = 293178
[done]

Reading destination surface /Users/dengemann/mne-hcp-data/hcp-subjects/105923/surf/rh.white
    Triangle neighbors and vertex normals...
Mapping rh fsaverage -&gt; 105923 (nearest neighbor)...
Triangle file: created by greve on Thu Jun  8 19:17:51 2006 nvert = 163842 ntri = 327680
Triangle file: created by HCPpipeline on Tue Aug 19 23:08:04 2014 nvert = 146287 ntri = 292570
[done]

Creating the BEM geometry...
inner skull CM is   0.77  -4.49 -13.14 mm
Surfaces passed the basic topology checks.
Complete.

Approximation method : Linear collocation

Homogeneous model surface loaded.
Computing the linear collocation solution...
    Matrix coefficients...
        inner_skull (5000) -&gt; inner_skull (5000) ...
    Inverting the coefficient matrix...
Solution ready.
BEM geometry computations complete.
Reading 4D PDF file /Users/dengemann/mne-hcp-data/HCP/105923/unprocessed/MEG/6-Wrkmem/4D/c,rfDC...
Creating Neuromag info structure ...
... Setting channel info structure.
... no headshape file supplied, doing nothing.
Currently direct inclusion of 4D weight tables is not supported. For critical use cases please take into account the MNE command &quot;mne_create_comp_data&quot; to include weights as printed out by the 4D &quot;print_table&quot; routine.
Source space                 : &lt;SourceSpaces: [&lt;surface (lh), n_vertices=146591, n_used=4098, coordinate_frame=MRI (surface RAS)&gt;, &lt;surface (rh), n_vertices=146287, n_used=4098, coordinate_frame=MRI (surface RAS)&gt;]&gt;
MRI -&gt; head transform source : dict
Measurement data             : instance of Info
BEM model                    : dict
Accurate field computations
Do computations in head coordinates
Free source orientations
Destination for the solution : None

Read 2 source spaces a total of 8196 active source locations

Coordinate transformation: MRI (surface RAS) -&gt; head
     0.012385  1.002568 -0.069429       1.92 mm
    -0.999752  0.013791  0.007142      -0.38 mm
     0.006757  0.074407  0.989380      50.97 mm
     0.000000  0.000000  0.000000       1.00

Read 248 MEG channels from info
72 coil definitions read
Coordinate transformation: MEG device -&gt; head
     1.000000  0.000000  0.000000       0.00 mm
     0.000000  1.000000  0.000000       0.00 mm
     0.000000  0.000000  1.000000       0.00 mm
     0.000000  0.000000  0.000000       1.00
MEG coil definitions created in head coordinates.
Source spaces are now in head coordinates.

Employing the head-&gt;MRI coordinate transform with the BEM model.
BEM model dict is now set up

Source spaces are in head coordinates.
Checking that the sources are inside the bounding surface (will take a few...)
Thank you for waiting.

Setting up compensation data...
    No compensation set. Nothing more to do.

Composing the field computation matrix...
Computing MEG at 8196 source locations (free orientations)...

Finished.
</pre></div>
</div>
<p>Now we can compute the noise covariance. For this purpose we will apply
the same filtering as was used for the computations of the ERF in the first
place. See also <a class="reference internal" href="plot_reproduce_erf.html#tut-reproduce-erf"><span>Computing ERFs from HCP</span></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">raw_noise</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read_raw_hcp</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">subject</span><span class="p">,</span> <span class="n">hcp_path</span><span class="o">=</span><span class="n">hcp_path</span><span class="p">,</span>
                            <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;noise_empty_room&#39;</span><span class="p">)</span>
<span class="n">raw_noise</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>

<span class="c1"># apply ref channel correction and drop ref channels</span>
<span class="n">preproc</span><span class="o">.</span><span class="n">apply_ref_correction</span><span class="p">(</span><span class="n">raw_noise</span><span class="p">)</span>

<span class="c1"># Note: MNE complains on Python 2.7</span>
<span class="n">raw_noise</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="mf">0.50</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;iir&#39;</span><span class="p">,</span>
                 <span class="n">iir_params</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ftype</span><span class="o">=</span><span class="s1">&#39;butter&#39;</span><span class="p">),</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">raw_noise</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;iir&#39;</span><span class="p">,</span>
                 <span class="n">iir_params</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ftype</span><span class="o">=</span><span class="s1">&#39;butter&#39;</span><span class="p">),</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre><span></span>Reading 4D PDF file /Users/dengemann/mne-hcp-data/HCP/105923/unprocessed/MEG/1-Rnoise/4D/c,rfDC...
Creating Neuromag info structure ...
... Setting channel info structure.
... no headshape file supplied, doing nothing.
Currently direct inclusion of 4D weight tables is not supported. For critical use cases please take into account the MNE command &quot;mne_create_comp_data&quot; to include weights as printed out by the 4D &quot;print_table&quot; routine.
Current compensation grade : 0
Reading 0 ... 610353  =      0.000 ...   300.000 secs...
High-pass filtering at 0.5 Hz
The default output type is &quot;ba&quot; in 0.13 but will change to &quot;sos&quot; in 0.14
Low-pass filtering at 60 Hz
The default output type is &quot;ba&quot; in 0.13 but will change to &quot;sos&quot; in 0.14
</pre></div>
</div>
<p>Note that using the empty room noise covariance will inflate the SNR of the
evkoked and renders comparisons  to <cite>baseline</cite> rather uninformative.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">noise_cov</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">compute_raw_covariance</span><span class="p">(</span><span class="n">raw_noise</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;empirical&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre><span></span>Using up to 1500 segments
Number of samples used : 610500
[done]
</pre></div>
</div>
<p>Now we assemble the inverse operator, project the data and show the results
on the <cite>fsaverage</cite> surface, the freesurfer average brain.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">inv_op</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">minimum_norm</span><span class="o">.</span><span class="n">make_inverse_operator</span><span class="p">(</span>
    <span class="n">evoked</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">fwd</span><span class="p">,</span> <span class="n">noise_cov</span><span class="o">=</span><span class="n">noise_cov</span><span class="p">)</span>

<span class="n">stc</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">minimum_norm</span><span class="o">.</span><span class="n">apply_inverse</span><span class="p">(</span>  <span class="c1"># these data have a pretty high SNR and</span>
    <span class="n">evoked</span><span class="p">,</span> <span class="n">inv_op</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;MNE&#39;</span><span class="p">,</span> <span class="n">lambda2</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mf">9.</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># 9 is a lovely number.</span>

<span class="n">stc</span> <span class="o">=</span> <span class="n">stc</span><span class="o">.</span><span class="n">to_original_src</span><span class="p">(</span>
    <span class="n">src_outputs</span><span class="p">[</span><span class="s1">&#39;src_fsaverage&#39;</span><span class="p">],</span> <span class="n">subjects_dir</span><span class="o">=</span><span class="n">subjects_dir</span><span class="p">)</span>

<span class="n">brain</span> <span class="o">=</span> <span class="n">stc</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="s1">&#39;fsaverage&#39;</span><span class="p">,</span> <span class="n">subjects_dir</span><span class="o">=</span><span class="n">subjects_dir</span><span class="p">,</span> <span class="n">hemi</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">brain</span><span class="o">.</span><span class="n">set_time</span><span class="p">(</span><span class="mi">145</span><span class="p">)</span>  <span class="c1"># we take the peak seen in :ref:`tut_plot_evoked` and</span>
<span class="n">brain</span><span class="o">.</span><span class="n">show_view</span><span class="p">(</span><span class="s1">&#39;caudal&#39;</span><span class="p">)</span>  <span class="c1"># admire wide spread visual activation.</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_compute_evoked_inverse_solution_001.png" class="align-center" src="../_images/sphx_glr_plot_compute_evoked_inverse_solution_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre><span></span>Converting to surface-based source orientations...
[done]
Computing inverse operator with 243 channels.
estimated rank (mag): 243
Setting small MEG eigenvalues to zero.
Not doing PCA for MEG.
Total rank is 243
Creating the depth weighting matrix...
    243 magnetometer or axial gradiometer channels
    limit = 8103/8196 = 10.002513
    scale = 7.85921e-11 exp = 0.8
Computing inverse operator with 243 channels.
Creating the source covariance matrix
Applying loose dipole orientations. Loose value of 0.2.
Whitening the forward solution.
Adjusting source covariance matrix.
Computing SVD of whitened and weighted lead field matrix.
    largest singular value = 6.60413
    scaling factor to adjust the trace = 3.34114e+20
Preparing the inverse operator for use...
    Scaled noise and source covariance from nave = 1 to nave = 160
    Created the regularized inverter
    The projection vectors do not apply to these channels.
    Created the whitener using a full noise covariance matrix (0 small eigenvalues omitted)
Picked 243 channels from the data
Computing inverse...
(eigenleads need to be weighted)...
combining the current components...
[done]
Mapping lh fsaverage -&gt; 105923 (nearest neighbor)...
Triangle file: created by greve on Thu Jun  8 19:17:51 2006 nvert = 163842 ntri = 327680
Triangle file: created by HCPpipeline on Tue Aug 19 21:54:25 2014 nvert = 146591 ntri = 293178
Mapping rh fsaverage -&gt; 105923 (nearest neighbor)...
Triangle file: created by greve on Thu Jun  8 19:17:51 2006 nvert = 163842 ntri = 327680
Triangle file: created by HCPpipeline on Tue Aug 19 23:08:04 2014 nvert = 146287 ntri = 292570
Updating smoothing matrix, be patient..
Smoothing matrix creation, step 1
Smoothing matrix creation, step 2
Smoothing matrix creation, step 3
Smoothing matrix creation, step 4
Smoothing matrix creation, step 5
Smoothing matrix creation, step 6
Smoothing matrix creation, step 7
Smoothing matrix creation, step 8
Smoothing matrix creation, step 9
Smoothing matrix creation, step 10
colormap: fmin=2.35e-11 fmid=2.79e-11 fmax=9.14e-11 transparent=1
Updating smoothing matrix, be patient..
Smoothing matrix creation, step 1
Smoothing matrix creation, step 2
Smoothing matrix creation, step 3
Smoothing matrix creation, step 4
Smoothing matrix creation, step 5
Smoothing matrix creation, step 6
Smoothing matrix creation, step 7
Smoothing matrix creation, step 8
Smoothing matrix creation, step 9
Smoothing matrix creation, step 10
colormap: fmin=2.35e-11 fmid=2.79e-11 fmax=9.14e-11 transparent=1
</pre></div>
</div>
<p><strong>Total running time of the script:</strong> ( 1 minutes  30.234 seconds)</p>
<div class="sphx-glr-download container">
<a class="reference download internal" href="../_downloads/plot_compute_evoked_inverse_solution.py"><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_compute_evoked_inverse_solution.py</span></code></a></div>
<div class="sphx-glr-download container">
<a class="reference download internal" href="../_downloads/plot_compute_evoked_inverse_solution.ipynb"><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_compute_evoked_inverse_solution.ipynb</span></code></a></div>
<p class="sphx-glr-signature"><a class="reference external" href="http://sphinx-gallery.readthedocs.io">Generated by Sphinx-Gallery</a></p>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016, Denis A. Engemann.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4a0+.<br/>
    </p>
  </div>
</footer>
  </body>
</html>